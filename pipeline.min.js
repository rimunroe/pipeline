!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("_")):"function"==typeof define&&define.amd?define(["_"],e):"object"==typeof exports?exports.pipeline=e(require("_")):t.pipeline=e(t._)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return t[r].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r=n(1),a=n(2),o=n(3),i=n(4),s=n(5),c=n(6),p=n(7),u=n(8),l=n(9),f=n(10),d=n(11),h=n(12);t.exports={createApp:function(t){t=t||{};var e={initializers:{stores:[],adapters:[]},startHooks:{},hasStarted:!1,actions:{},stores:{},storeContexts:{},adapters:{},helpers:{},plugins:{},debug:t.debug};e.usePlugin=l(e),e.status=o(e),e.load=i(e);var n=s(e),y=c(e),g=p(e),v=u(e);if(e.create={action:n,actions:h(n),store:y,stores:h(y),adapter:g,adapters:h(g),helper:v,helpers:h(v)},r.isFunction(t.initialize)&&(e.initializers.app=t.initialize),e.start=f(e),e.dispatcher=d(e),null!=t.plugins)if(r.isArray(t.plugins))r.forEach(t.plugins,function(t){e.usePlugin(t)});else{if(!r.isObject(t.plugins))throw new a.badPluginsList;e.usePlugin(t.plugins)}var b=r.omit(e,["dispatcher","debug","initializers","hasStarted","status","dispatcher","storeContexts"]);return e.app=b,t.debug&&(b._ctx=e),b}}},function(e){e.exports=t},function(t){function e(){this.message='"plugins" must be an array or an object.';var t=new Error;this.stack=t.stack}function n(){this.message="Plugin must be named.";var t=new Error;this.stack=t.stack}function r(t,e){this.message='Plugin "'+t+'" attempts to overwrite the following keys on app.create: '+e.join(", ")+".";var n=new Error;this.stack=n.stack}function a(){this.message="No plugin object supplied.";var t=new Error;this.stack=t.stack}function o(t){this.message='Missing dependency for action "'+t+'".';var e=new Error;this.stack=e.stack}function i(){this.message="There is a cyclic dependency in your app.";var t=new Error;this.stack=t.stack}function s(t){this.message='Cannot create new action "'+t+'". App has already started.';var e=new Error;this.stack=e.stack}function c(t){this.message='Invalid values passed to action "'+t+'". Aborting dispatch.';var e=new Error;this.stack=e.stack}function p(t){this.message='Cannot create new store "'+t+'". App has already started.';var e=new Error;this.stack=e.stack}function u(t){this.message='Store "'+t+'" waits for itself.';var e=new Error;this.stack=e.stack}function l(t,e){this.message='In "'+t+'" Store: "'+e+'" is a reserved key and cannot be used.';var n=new Error;this.stack=n.stack}function f(t){this.message='API key "'+t+'" is a reserved key and cannot be used.';var e=new Error;this.stack=e.stack}e.prototype=Object.create(Error.prototype),e.prototype.name="Bad Plugins List",n.prototype=Object.create(Error.prototype),n.prototype.name="No Plugin Name",r.prototype=Object.create(Error.prototype),r.prototype.name="Bad Plugin Key",a.prototype=Object.create(Error.prototype),a.prototype.name="No Plugin Object",o.prototype=Object.create(Error.prototype),o.prototype.name="Missing Dependency",i.prototype=Object.create(Error.prototype),i.prototype.name="Cyclic Dependency",s.prototype=Object.create(Error.prototype),s.prototype.name="Action Created Post App Start",c.prototype=Object.create(Error.prototype),c.prototype.name="Action Validation Failure",p.prototype=Object.create(Error.prototype),p.prototype.name="Store Created Post-App Start",u.prototype=Object.create(Error.prototype),u.prototype.name="Self Waiting Store",l.prototype=Object.create(Error.prototype),l.prototype.name="Store Used Bad Keys",f.prototype=Object.create(Error.prototype),f.prototype.name="Store Used Reserved API Key",t.exports={main:{badPluginsList:e},plugins:{noName:n,badKeys:r,noPluginObject:a},dispatcher:{missingDependency:o,cyclicDependency:i},actions:{appHasStarted:s,failedValidation:c},stores:{appHasStarted:p,waitingForSelf:u,usedBadKeys:l,usedReservedAPIKey:f}}},function(t,e,n){var r=n(1);t.exports=function(t){var e=function(e){"stores"===e?console.log(stores):"dispatcher"===e&&console.log(t.dispatcher)};return function(){var t=arguments.length>=1?[].prototype.slice.call(arguments):[];r.each(t,e)}}},function(t,e,n){var r=n(1);t.exports=function(t){return function(e){r.each(e,function(e,n){"helpers"===n?t.createHelpers(e):"views"===n?t.createViews(e):"stores"===n?t.createStores(e):"adapters"===n?t.createAdapters(e):"actions"===n?t.createActions(e):console.log("Load Error:  Unknown key '"+n+"' with value of: "+e," Top level keys should be 'helpers', 'views', 'stores', 'adapters' or 'actions'.")})}}},function(t,e,n){var r=n(1),a=n(2);t.exports=function(t){return function(e,n){if(t.hasStarted)throw new a.actions.appHasStarted(e);var o=function(){var o=!0,i=[];if(r.isFunction(n)){var s={require:function(t,e){t||(o=!1,null!=e&&i.push(e))}};n.apply(s,arguments)}if(!o)throw r.forEach(i,function(t){console.log(t)}),new a.actions.failedValidation(e);t.dispatcher.enqueueAction(e,arguments)};return o.actionName=e,t.actions[e]=o,o}}},function(t,e,n){var r=n(1),a=n(2);t.exports=function(t){var e=function(t,e){for(var n={},r=0;r<t.length;r++){var a=t[r];n[a]=e(a)}return n};return function(n,o){if(t.hasStarted)throw new a.stores.appHasStarted(n);var i,s={},c=function(t,e){if("object"==typeof t)for(var n in t)s[n]=t[n];else"string"==typeof t&&(s[t]=e)};if(i="string"==typeof o.after?[o.after]:Array.isArray(o.after)?o.after:[],i.indexOf(n)>=0)throw new a.stores.waitingForSelf(n);var p=["name","stores","get","update"],u=r.intersection(r.keys(o),p);r.isEmpty(u)||r.each(u,function(t){throw new a.stores.usedBadKeys(n,t)});var l=r.omit(o,["initialize","api","actions"]);r.each(l,function(t,e){r.isFunction(t)&&(l[e]=t.bind(l))});var f=function(){t.dispatcher.storeHasChanged(n)},d=e(i,function(e){return t.stores[e]});r.extend(l,{actions:t.actions,name:n,api:{},stores:d,get:function(t){return r.clone(null!=t?s[t]:s)},update:function(t,e){c(t,e),f()}});var h={get:function(t){return r.cloneDeep(null!=t?s[t]:s)}};if(r.forEach(o.api,function(t,e){if(r.contains(p,e))throw new a.stores.usedReservedAPIKey(e);var n=t.bind(l);l[e]=n,h[e]=n}),r.forEach(o.actions,function(e,r){var a=function(){e.apply(l,arguments)};t.dispatcher.onAction(n,r,i,a)}),r.isFunction(o.initialize)){var y=r.omit(l,["actions","update"]);y.update=c,t.initializers.stores.push(o.initialize.bind(y))}return(1==t.debug||r.contains(t.debug,n))&&(h._ctx=l),t.stores[n]=h,t.storeContexts[n]=l,h}}},function(t,e,n){var r=n(1);t.exports=function(t){return function(e,n){var a={name:e,stores:t.stores,actions:t.actions};return r.forEach(r.omit(n,["stores","initialize"]),function(t,e){a[e]=r.isFunction(t)?t.bind(a):t}),r.forEach(n.stores,function(n,r){t.dispatcher.registerStoreCallback(r,n.bind(a),e)}),r.isFunction(n.initialize)&&t.initializers.adapters.push(n.initialize.bind(r.omit(a,"actions"))),t.adapters[e]=a,a}}},function(t,e,n){var r=n(1);t.exports=function(t){return function(e,n){if(t.hasStarted)throw new Error('cannot create new helper "'+e+'". App has already started.');var a={helpers:t.helpers},o=function(){n.apply(a,arguments)};o.name=e;var i=e.split("."),s=t.helpers,c=i.slice(0,-1),p=i.slice(-1)[0];return r.each(c,function(t){s[t]||(s[t]={}),s=s[t]}),s[p]=o,o}}},function(t,e,n){var r=n(2);t.exports=function(t){return function(e){if(null==e)throw new r.plugins.noPluginObject;var n=e.name;if(null==n)throw new r.plugin.noName;if("object"==typeof e.factories){var a=_.intersection(_.keys(e.factories),_.keys(t.create));if(!_.isEmpty(a))throw new r.plugins.badKeys(n,a);var o={};_.forEach(e.factories,function(e,n){o[n]=e.call(null,t)}),_.extend(t.create,o)}"function"==typeof e.startHook&&(t.startHooks[n]=e.startHook)}}},function(t,e,n){var r=n(1);t.exports=function(t){var e=function(){if(t.dispatcher.initialize(),r.forEach(t.initializers.stores,function(t){t()}),delete t.initializers.stores,r.forEach(t.initializers.adapters,function(t){t()}),delete t.initializers.adapters,t.dispatcher.runStoreCallbacks(),t.dispatcher.canDispatch=!0,r.forEach(t.startHooks,function(e,n){console.log('Running plugin "'+n+"\"'s start hook"),e.call(null,t)}),r.isFunction(t.initializers.app)){var e={stores:t.stores,actions:t.actions,helpers:t.helpers};t.initializers.app.call(e)}t.hasStarted=!0};return function(){t.hasStarted?console.log("App was already started."):(e(),delete t.app.create,delete t.app.load,delete t.app.start)}}},function(t,e,n){var r=n(1),a=n(2);t.exports=function(t){var e={canDispatch:!1,actionQueue:[],actionCallbacks:{},storeCallbacks:{},changedStores:{}};return r.extend(e,{initialize:function(){function n(t){var n=e.actionCallbacks[t],o=[];r.forEach(n,function(n){r.forEach(n.after,function(n){var a=r.pluck(e.actionCallbacks[t],"storeName");-1===a.indexOf(n)&&o.push(n)})});for(var i=r.filter(n,function(t){var e=r.isEmpty(r.difference(t.after,o));return e?!0:void 0}),s=r.pluck(i,"storeName"),c=r.difference(n,i),p=!0,u=function(t){return s.indexOf(t)>=0},l=function(t){return o.indexOf(t)>=0},f=function(t){r.every(t.after,function(t){return u(t)||l(t)})&&(p=!1,i.push(t),s.push(t.storeName))};!r.isEmpty(c);){if(p=!0,c.forEach(f),p)throw new a.dispatcher.cyclicDependency;c=r.difference(c,i)}e.actionCallbacks[t]=i}r.forEach(t.storeContexts,function(e){null!=e.stores&&r.forEach(e.stores,function(n,r){null==n&&(e.stores[r]=t.stores[r])})});for(var o in e.actionCallbacks)n(o)},onAction:function(t,n,r,a){null==e.actionCallbacks[n]&&(e.actionCallbacks[n]=[]),e.actionCallbacks[n].push({storeName:t,after:r||[],callback:a})},registerStoreCallback:function(t,n,r){null==e.storeCallbacks[t]&&(e.storeCallbacks[t]=[]),e.storeCallbacks[t].push({adapterName:r,callback:n})},unregisterStoreCallback:function(t,n){r.remove(e.storeCallbacks[t],function(t){return t.callback===n})},storeHasChanged:function(t){e.changedStores[t]=!0},dispatchAction:function(t,n){null!=e.actionCallbacks[t]&&r.forEach(e.actionCallbacks[t],function(t){t.callback.apply(null,n)});for(var a in e.changedStores)null!=e.storeCallbacks[a]&&r.forEach(e.storeCallbacks[a],function(t){void 0!=t&&t.callback()})},dispatchActions:function(){e.canDispatch=!1;for(var t=0;t<e.actionQueue.length;t++){var n=e.actionQueue[t].actionName,r=e.actionQueue[t].args;e.dispatchAction(n,r)}e.actionQueue=[],e.canDispatch=!0},enqueueAction:function(t,n){e.actionQueue.push({actionName:t,args:n}),e.canDispatch&&e.dispatchActions()},runStoreCallbacks:function(){for(var t in e.changedStores)if(null!=e.storeCallbacks[t])for(var n in e.storeCallbacks[t])n.callback()}}),e}},function(t,e,n){var r=n(1);t.exports=function(t){return function(e,n){"string"==typeof e&&n?t.call(null,e,n):r.isObject(e)&&r.each(e,function(e,n){t.call(null,n,e)})}}}])});