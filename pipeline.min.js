!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("_")):"function"==typeof define&&define.amd?define(["_"],e):"object"==typeof exports?exports.pipeline=e(require("_")):t.pipeline=e(t._)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var n=r(1),a=r(2),o=r(3),i=r(4),s=r(5),c=r(6),p=r(7),u=r(8),l=r(9),f=r(10),d=r(11),h=r(12);t.exports={createApp:function(t){t=t||{};var e={initializers:{stores:[],adapters:[]},startHooks:{},hasStarted:!1,actions:{},stores:{},storeContexts:{},adapters:{},helpers:{},plugins:{},debug:t.debug};e.usePlugin=l(e),e.status=o(e),e.load=i(e);var r=s(e),y=c(e),g=p(e),v=u(e);if(e.create={action:r,actions:h(r),store:y,stores:h(y),adapter:g,adapters:h(g),helper:v,helpers:h(v)},n.isFunction(t.initialize)&&(e.initializers.app=t.initialize),e.start=f(e),e.dispatcher=d(e),null!=t.plugins)if(n.isArray(t.plugins))n.forEach(t.plugins,function(t){e.usePlugin(t)});else{if(!n.isObject(t.plugins))throw new a.badPluginsList;e.usePlugin(t.plugins)}var b=n.omit(e,["dispatcher","debug","initializers","hasStarted","status","dispatcher","storeContexts"]);return e.app=b,t.debug&&(b._ctx=e),b}}},function(e){e.exports=t},function(t){function e(){this.message='"plugins" must be an array or an object.';var t=new Error;this.stack=t.stack}function r(){this.message="Plugin must be named.";var t=new Error;this.stack=t.stack}function n(t,e){this.message='Plugin "'+t+'" attempts to overwrite the following keys on app.create: '+e.join(", ")+".";var r=new Error;this.stack=r.stack}function a(){this.message="No plugin object supplied.";var t=new Error;this.stack=t.stack}function o(t){this.message='Missing dependency for action "'+t+'".';var e=new Error;this.stack=e.stack}function i(){this.message="There is a cyclic dependency in your app.";var t=new Error;this.stack=t.stack}function s(t){this.message='Cannot create new action "'+t+'". App has already started.';var e=new Error;this.stack=e.stack}function c(t){this.message='Invalid values passed to action "'+t+'". Aborting dispatch.';var e=new Error;this.stack=e.stack}function p(t){this.message='Cannot create new store "'+t+'". App has already started.';var e=new Error;this.stack=e.stack}function u(t){this.message='Store "'+t+'" waits for itself.';var e=new Error;this.stack=e.stack}function l(t,e){this.message='In "'+t+'" Store: "'+e+'" is a reserved key and cannot be used.';var r=new Error;this.stack=r.stack}function f(t){this.message='API key "'+t+'" is a reserved key and cannot be used.';var e=new Error;this.stack=e.stack}e.prototype=Object.create(Error.prototype),e.prototype.name="Bad Plugins List",r.prototype=Object.create(Error.prototype),r.prototype.name="No Plugin Name",n.prototype=Object.create(Error.prototype),n.prototype.name="Bad Plugin Key",a.prototype=Object.create(Error.prototype),a.prototype.name="No Plugin Object",o.prototype=Object.create(Error.prototype),o.prototype.name="Missing Dependency",i.prototype=Object.create(Error.prototype),i.prototype.name="Cyclic Dependency",s.prototype=Object.create(Error.prototype),s.prototype.name="Action Created Post App Start",c.prototype=Object.create(Error.prototype),c.prototype.name="Action Validation Failure",p.prototype=Object.create(Error.prototype),p.prototype.name="Store Created Post-App Start",u.prototype=Object.create(Error.prototype),u.prototype.name="Self Waiting Store",l.prototype=Object.create(Error.prototype),l.prototype.name="Store Used Bad Keys",f.prototype=Object.create(Error.prototype),f.prototype.name="Store Used Reserved API Key",t.exports={main:{badPluginsList:e},plugins:{noName:r,badKeys:n,noPluginObject:a},dispatcher:{missingDependency:o,cyclicDependency:i},actions:{appHasStarted:s,failedValidation:c},stores:{appHasStarted:p,waitingForSelf:u,usedBadKeys:l,usedReservedAPIKey:f}}},function(t,e,r){var n=r(1);t.exports=function(t){var e=function(e){"stores"===e?console.log(stores):"dispatcher"===e&&console.log(t.dispatcher)};return function(){var t=arguments.length>=1?[].prototype.slice.call(arguments):[];n.each(t,e)}}},function(t,e,r){var n=r(1);t.exports=function(t){return function(e){n.each(e,function(e,r){"helpers"===r?t.createHelpers(e):"views"===r?t.createViews(e):"stores"===r?t.createStores(e):"adapters"===r?t.createAdapters(e):"actions"===r?t.createActions(e):console.log("Load Error:  Unknown key '"+r+"' with value of: "+e," Top level keys should be 'helpers', 'views', 'stores', 'adapters' or 'actions'.")})}}},function(t,e,r){var n=r(1),a=r(2);t.exports=function(t){return function(e,r){if(t.hasStarted)throw new a.actions.appHasStarted(e);var o=function(){var a=!0,o=[];if(n.isFunction(r)){var i={require:function(t,e){t||(a=!1,null!=e&&o.push(e))}};try{r.apply(i,arguments)}catch(s){a=!1,console.log('An error was thrown in the validator for action "'+e+'"')}}a?t.dispatcher.enqueueAction(e,arguments):n.forEach(o,function(t){console.log(t)})};return o.actionName=e,t.actions[e]=o,o}}},function(t,e,r){var n=r(1),a=r(2);t.exports=function(t){var e=function(t,e){for(var r={},n=0;n<t.length;n++){var a=t[n];r[a]=e(a)}return r};return function(r,o){if(t.hasStarted)throw new a.stores.appHasStarted(r);var i,s={},c=function(t,e){if("object"==typeof t)for(var r in t)s[r]=t[r];else"string"==typeof t&&(s[t]=e)};if(i="string"==typeof o.after?[o.after]:Array.isArray(o.after)?o.after:[],i.indexOf(r)>=0)throw new a.stores.waitingForSelf(r);var p=["name","stores","get","update"],u=n.intersection(n.keys(o),p);n.isEmpty(u)||n.each(u,function(t){throw new a.stores.usedBadKeys(r,t)});var l=n.omit(o,["initialize","api","actions"]);n.each(l,function(t,e){n.isFunction(t)&&(l[e]=t.bind(l))});var f=function(){t.dispatcher.storeHasChanged(r)},d=e(i,function(e){return t.stores[e]});n.extend(l,{actions:t.actions,name:r,api:{},stores:d,get:function(t){return n.clone(null!=t?s[t]:s)},update:function(t,e){c(t,e),f()}});var h={get:function(t){return n.cloneDeep(null!=t?s[t]:s)}};if(n.forEach(o.api,function(t,e){if(n.contains(p,e))throw new a.stores.usedReservedAPIKey(e);var r=t.bind(l);l[e]=r,h[e]=r}),n.forEach(o.actions,function(e,n){var a=function(){e.apply(l,arguments)};t.dispatcher.onAction(r,n,i,a)}),n.isFunction(o.initialize)){var y=n.omit(l,["actions","update"]);y.update=c,t.initializers.stores.push(o.initialize.bind(y))}return(1==t.debug||n.contains(t.debug,r))&&(h._ctx=l),t.stores[r]=h,t.storeContexts[r]=l,h}}},function(t,e,r){var n=r(1);t.exports=function(t){return function(e,r){var a={name:e,stores:t.stores,actions:t.actions};return n.forEach(n.omit(r,["stores","initialize"]),function(t,e){a[e]=n.isFunction(t)?t.bind(a):t}),n.forEach(r.stores,function(r,n){t.dispatcher.registerStoreCallback(n,r.bind(a),e)}),n.isFunction(r.initialize)&&t.initializers.adapters.push(r.initialize.bind(n.omit(a,"actions"))),t.adapters[e]=a,a}}},function(t,e,r){var n=r(1);t.exports=function(t){return function(e,r){if(t.hasStarted)throw new Error('cannot create new helper "'+e+'". App has already started.');var a={helpers:t.helpers},o=function(){r.apply(a,arguments)};o.name=e;var i=e.split("."),s=t.helpers,c=i.slice(0,-1),p=i.slice(-1)[0];return n.each(c,function(t){s[t]||(s[t]={}),s=s[t]}),s[p]=o,o}}},function(t,e,r){var n=r(2);t.exports=function(t){return function(e){if(null==e)throw new n.plugins.noPluginObject;var r=e.name;if(null==r)throw new n.plugin.noName;if("object"==typeof e.factories){var a=_.intersection(_.keys(e.factories),_.keys(t.create));if(!_.isEmpty(a))throw new n.plugins.badKeys(r,a);var o={};_.forEach(e.factories,function(e,r){o[r]=e.call(null,t)}),_.extend(t.create,o)}"function"==typeof e.startHook&&(t.startHooks[r]=e.startHook)}}},function(t,e,r){var n=r(1);t.exports=function(t){var e=function(){if(t.dispatcher.initialize(),n.forEach(t.initializers.stores,function(t){t()}),delete t.initializers.stores,n.forEach(t.initializers.adapters,function(t){t()}),delete t.initializers.adapters,t.dispatcher.runStoreCallbacks(),t.dispatcher.canDispatch=!0,n.forEach(t.startHooks,function(e,r){console.log('Running plugin "'+r+"\"'s start hook"),e.call(null,t)}),n.isFunction(t.initializers.app)){var e={stores:t.stores,actions:t.actions,helpers:t.helpers};t.initializers.app.call(e)}t.hasStarted=!0};return function(){t.hasStarted?console.log("App was already started."):(e(),delete t.app.create,delete t.app.load,delete t.app.start)}}},function(t,e,r){var n=r(1),a=r(2);t.exports=function(t){var e={canDispatch:!1,actionQueue:[],actionCallbacks:{},storeCallbacks:{},changedStores:{}};return n.extend(e,{initialize:function(){function r(t){var r=e.actionCallbacks[t],o=[];n.forEach(r,function(r){n.forEach(r.after,function(r){var a=n.pluck(e.actionCallbacks[t],"storeName");-1===a.indexOf(r)&&o.push(r)})});for(var i=n.filter(r,function(t){var e=n.isEmpty(n.difference(t.after,o));return e?!0:void 0}),s=n.pluck(i,"storeName"),c=n.difference(r,i),p=!0,u=function(t){return s.indexOf(t)>=0||o.indexOf(t)>=0},l=function(t){n.every(t.after,function(t){return u(t)})&&(p=!1,i.push(t),s.push(t.storeName))};!n.isEmpty(c);){if(p=!0,c.forEach(l),p)throw new a.dispatcher.cyclicDependency;c=n.difference(c,i)}e.actionCallbacks[t]=i}n.forEach(t.storeContexts,function(e){null!=e.stores&&n.forEach(e.stores,function(r,n){null==r&&(e.stores[n]=t.stores[n])})});for(var o in e.actionCallbacks)r(o)},onAction:function(t,r,n,a){null==e.actionCallbacks[r]&&(e.actionCallbacks[r]=[]),e.actionCallbacks[r].push({storeName:t,after:n||[],callback:a})},registerStoreCallback:function(t,r,n){null==e.storeCallbacks[t]&&(e.storeCallbacks[t]=[]),e.storeCallbacks[t].push({adapterName:n,callback:r})},unregisterStoreCallback:function(t,r){n.remove(e.storeCallbacks[t],function(t){return t.callback===r})},storeHasChanged:function(t){e.changedStores[t]=!0},dispatchAction:function(t,r){null!=e.actionCallbacks[t]&&n.forEach(e.actionCallbacks[t],function(t){t.callback.apply(null,r)});for(var a in e.changedStores)null!=e.storeCallbacks[a]&&n.forEach(e.storeCallbacks[a],function(t){void 0!=t&&t.callback()})},dispatchActions:function(){e.canDispatch=!1;for(var t=0;t<e.actionQueue.length;t++){var r=e.actionQueue[t].actionName,n=e.actionQueue[t].args;e.dispatchAction(r,n)}e.actionQueue=[],e.canDispatch=!0},enqueueAction:function(t,r){e.actionQueue.push({actionName:t,args:r}),e.canDispatch&&e.dispatchActions()},runStoreCallbacks:function(){for(var t in e.changedStores)if(null!=e.storeCallbacks[t])for(var r in e.storeCallbacks[t])r.callback()}}),e}},function(t,e,r){var n=r(1);t.exports=function(t){return function(e,r){"string"==typeof e&&r?t.call(null,e,r):n.isObject(e)&&n.each(e,function(e,r){t.call(null,r,e)})}}}])});