(function(){var t,n,r,e=[].indexOf||function(t){for(var n=0,r=this.length;r>n;n++)if(n in this&&this[n]===t)return n;return-1},i=[].slice;t="undefined"==typeof window,r=t?require("lodash"):this._,n={},n={createApp:function(){var t,n,o,a;return o=function(t,n){var r,e,i,o;for(e={},i=0,o=t.length;o>i;i++)r=t[i],e[r]=n(r);return e},a=function(t){var n,i,o,a,s,c,u;if(o=r.filter(t,function(t){return r.isEmpty(t.after)}),r.isEmpty(o))return!1;for(a=r.pluck(o,"storeKey"),s=r.difference(t,o);!r.isEmpty(s);){for(i=!0,c=0,u=s.length;u>c;c++)n=s[c],r.every(n.after,function(t){return e.call(a,t)>=0})&&(i=!1,o.push(n),a.push(n.storeKey));if(i)return!1;s=r.difference(s,o)}return o},n=!1,t={actionCallbacks:{},storeCallbacks:{},changedStores:{},onAction:function(t,n,e,i){var o,s;if(null==this.actionCallbacks[n]&&(this.actionCallbacks[n]=[]),r.every(e,function(t){return function(e){return r.find(t.actionCallbacks[n],function(t){return e===t.storeKey})}}(this))||(o=!0),this.actionCallbacks[n].push({storeKey:t,after:e||[],callback:i}),!o){if(s=a(this.actionCallbacks[n]),s===!1)throw this.actionCallbacks[n].pop(),new Error('store "'+t+'"\'s action "'+n+'" creates a circular dependency');return this.actionCallbacks[n]=s}},registerStoreCallback:function(t,n,r){var e;return null==(e=this.storeCallbacks)[t]&&(e[t]=[]),this.storeCallbacks[t].push({adapterKey:n,callback:r})},unregisterStoreCallback:function(t,n){return r.remove(this.storeCallbacks[t],n)},storeHasChanged:function(t){return this.changedStores[t]=!0},sendAction:function(t,e){var i;return i=function(r){return function(){var i,o,a,s,c,u,l,f,h,p;if(n=!0,r.changedStores={},null!=r.actionCallbacks[t])for(f=r.actionCallbacks[t],s=0,u=f.length;u>s;s++)i=f[s],i.callback(e);h=r.changedStores;for(o in h)if(a=h[o],null!=r.storeCallbacks[o])for(p=r.storeCallbacks[o],c=0,l=p.length;l>c;c++)i=p[c],i.callback();return n=!1}}(this),n?r.defer(i):i()}},{actions:{},stores:{},createActions:function(t){return r.forEach(t,function(t){return function(n,r){return t.createAction(r,n)}}(this))},createAction:function(n,r){return this.actions[n]=function(){return function(){var e,o;return e=1<=arguments.length?i.call(arguments,0):[],o=r.apply(null,e),t.sendAction(n,"object"==typeof o?o:{})}}(this)},createStore:function(n,i){var a,s,c,u,l,f,h;if(s=[],c={},a="string"==typeof i.after?[i.after]:Array.isArray(i.after)?i.after:[],e.call(a,n)>=0)throw new Error('store "'+n+'" waits for itself');return u=r.intersection(r.keys(i),["stores","key","trigger","get","update"]),r.isEmpty(u)||r.each(u,function(t){throw new Error('In "'+n+'" Store: "'+t+'" is a reserved key and cannot be used.')}),h=r.omit(i,["api","actions"]),r.each(h,function(t,n){return r.isFunction(t)?h[n]=t.bind(h):void 0}),r.extend(h,{key:n,api:{},trigger:function(){return t.storeHasChanged(this.key)},get:function(t){return r.clone(null!=t?c[t]:c)},update:function(t,r){var e;if("object"==typeof t)for(n in t)e=t[n],c[n]=e;else"string"==typeof t&&(c[t]=r);return this.trigger()}}),f=this.stores,l={get:function(t){return r.cloneDeep(null!=t?c[t]:c)}},r.forEach(i.api,function(t,n){var r;return"get"!==n?(r=t.bind(h),h.api[n]=r,l[n]=r):void 0}),r.forEach(i.actions,function(i,s){var c,u,l;if("function"==typeof i)l=a,c=i;else{if(n===i.after||e.call(i.after,n)>=0)throw new Error('on action "'+s+'", store "'+n+'" waits for itself to update');l=r.unique(a.concat(i.after)),c=i.action}return u=function(t){return h.action=r.isObject(t)?t:{},h.stores=o(l,function(t){return f[t]}),c.call(h),h.action={}},t.onAction(n,s,l,u)}),this.stores[n]=l,l},createAdapter:function(n,r){var e,i,o,a,s,c,u;s={key:n,stores:this.stores,actions:this.actions};for(i in r)o=r[i],"stores"!==i&&"function"==typeof o&&(s[i]=o.bind(s));c=r.stores,u=[];for(a in c)e=c[a],u.push(t.registerStoreCallback(a,n,e.bind(s)));return u},reactMixin:function(n){var e,i,o,a;for(r.isString(n)&&(n=[n]),i={},o=0,a=n.length;a>o;o++)e=n[o],i[e]=this.stores[e];return{stores:i,actions:this.actions,componentDidMount:function(){var i,o,a,s,c;for(c=[],a=0,s=n.length;s>a;a++)e=n[a],i=e.charAt(0).toUpperCase()+e.slice(1),o=this["on"+i+"Change"],c.push(r.isFunction(o)?t.registerStoreCallback(e,"react-view",o):void 0);return c},componentWillUnmount:function(){var i,o,a,s,c;for(c=[],a=0,s=n.length;s>a;a++)e=n[a],i=e.charAt(0).toUpperCase()+e.slice(1),o=this["on"+i+"Change"],c.push(r.isFunction(o)?t.unregisterStoreCallback(e,o):void 0);return c}}},start:function(t){return console.log("starting, initializers: ",this.initializers),r.each(this.initializers,function(t){return t()}),delete this.initializers,r.isFunction(t)?t.call(this):void 0}}}},t?module.exports=n:window.pipeline=n}).call(this);